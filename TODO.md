[ ] Add thermodynamic output
[ ] Check 2D-1D behavior
[ ] Profile and send needed parts to c/c++
[ ] Adjust analysis code for this method
[x] There is a problem with energy calculation, work it out!
